# BeeBERT
MLOps tools for Kaz-RoBERTA-conversational (BeeBERT)

## Введение
19-миллионное население Казахстана говорит на казахском языке, но все более важная технология ИИ до сих пор не поддерживает этот язык. Beeline Казахстан проводит разработки лингвистических моделей ИИ для поддержки казахского языка. [Kaz-RoBERTA-conversational](https://huggingface.co/kz-transformers/kaz-roberta-conversational), или сокращенно BeeBERT, — это генеративная технология ИИ, разрабатываемая Beeline. 

## Формулировка задачи: 
Классификация отзывов пользователей казахского электронного магазина [kaspi shop](https://kaspi.kz/shop/almaty/). Определить общую тональность комментариев, отзывов, проанализировать мнение и отзывы покупателей магазина по отношению к качеству предоставляемой продукции, доставки и т.д. Конкретно в рамках данного проекта - классифицировать отзывы на 2 класса (позитивные и негативные). 
 
Решение поставленной задачи позволит бизнесу яснее понимать отношение клиентов к продукту и находить точки роста для улучшения показателей в тех или иных направлениях.

## Датасет: 
Данные спаршены из отзывов с сайта [kaspi shop](https://kaspi.kz/shop/almaty/). На сайте вместе с отзывми есть оценки по 5-бальной шкале. Оценки 0 и 1 относим к негативным отзывам, 3-5 - к позитивным. Тем самым получаем датасет, в котором находится отзыв и флаг позитивности/негативности. В train датасете - 5404 отзывов, в test - 1352.

## Модель:
Модель основана на архитектуре Roberta. Используется предварительно обученная модель Roberta для казахского языка из библиотеки Transformers ([kaz-roberta](https://huggingface.co/kz-transformers/kaz-roberta-conversational)). Далее линейный слой для предварительной обработки выхода модели перед классификацией. Слой Dropout для регуляризации и предотвращения переобучения. Линейный слой для финальной классификации.

## Применение в продакшене
1. получение всех отзывов-комментариев, уже существующих, а также новых появляющихся  
2. запуск скрипта инференса модели  
3. сохранение результатов на сервере  
4. удаление большей части негативных отзывов для повышения доверия покупателей, шучу. Анализ слабых мест.

## Схема проекта
```
.
├── README.md
├── data
│   ├── test_data.csv.dvc
│   └── train_data.csv.dvc
├── infer.py
├── poetry.lock
├── pyproject.toml
├── train.py
└── utils
    ├── __init__.py
    ├── data_utils.py
    ├── model_utils.py
    └── train_utils.py

3 directories, 11 files
```

## Как запустить
```
git clone https://github.com/KashtanGreen/BeeBERT.git
cd BeeBERT

conda create -n mlops python=3.11 -y
conda activate mlops
poetry init
poetry install

pre-commit install
pre-commit run -a

python train.py
python infer.py
```

